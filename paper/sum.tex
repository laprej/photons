%======================================================================
%----------------------------------------------------------------------
%               XX                              X
%                                               X
%               XX    XXX   XXX   XXX      XXX  X  XXXX
%                X   X   X X   X X   X    X   X X X
%                X   XXXXX XXXXX XXXXX    X     X  XXX
%                X   X     X     X     XX X   X X     X
%               XXX   XXX   XXX   XXX  XX  XXX  X XXXX
%----------------------------------------------------------------------
%  	         A SKELETON FILE FOR IEEE PAPER GENERATION
%----------------------------------------------------------------------
%======================================================================

% first, uncomment the desired options:
\documentclass[%
        %draft,
        %submission,
        %compressed,
        final,
        %
        %technote,
        %internal,
        %submitted,
        %inpress,
        %reprint,
        %
        %titlepage,
        notitlepage,
        %anonymous,
        narroweqnarray,
        inline,
        twoside,
        ]{ieee}
%
% some standard modes are:
%
% \documentclass[draft,narroweqnarray,inline]{ieee}
% \documentclass[submission,anonymous,narroweqnarray,inline]{ieee}
% \documentclass[final,narroweqnarray,inline]{ieee}

% Use the `endfloat' package to move figures and tables to the end
% of the paper. Useful for `submission' mode.
%\usepackage {endfloat}

% Use the `times' package to use Helvetica and Times-Roman fonts
% instead of the standard Computer Modern fonts. Useful for the 
% IEEE Computer Society transactions.
% (Note: If you have the commercial package `mathtime,' it is much
% better, but the `times' package works too).
%\usepackage {times}

% In order to use the figure-defining commands in ieeefig.sty...
\usepackage{ieeefig}

\usepackage{url}

\begin{document}

%----------------------------------------------------------------------
% Title Information, Abstract and Keywords
%----------------------------------------------------------------------
\title[Short Title]{%
       Accurate Radio Transmission Using Photon Mapping}

% format author this way for journal articles.
\author[SHORT NAMES]{%
      Justin M. LaPre
      \authorinfo{%
        J. LaPre is a Ph.D. student in the Department of Computer
        Science, Rensselaer Polytechnic Institute, Troy, NY, 12180, USA.}
      \and
      Mark E. Anderson
      \authorinfo{%
        M. Anderson is a Ph.D. student in the Department of Computer
        Science, Rensselaer Polytechnic Institute, Troy, NY, 12180, USA.}
  }

% format author this way for conference proceedings
%\author[SHORT NAMES]{%
%      Mark E. Anderson\member{Fellow}
%      \authorinfo{%
%      Department of Electrical Engineering\\
%      Some University, Somewhere CA, 90210, USA\\
%      Phone: (xxx) xxx-xxxx, email: xxx@xxxx.xxx.xxx}
%    \and
%      Justin M. LaPre\member{Senior Member}
%      \authorinfo{%
%      Department of Electrical Engineering...}
%  }

% specifiy the journal name
\journal{Advanced Computer Graphics, Spring 2011}

% Or, when the paper is a preprint, try this...
%\journal{IEEE Transactions on Something, 1997, TN\#9999.}

% Or, specify the conference place and date.
%\confplacedate{Troy, NY, USA, May 11, 2010}

% make the title
\maketitle               

% do the abstract
\begin{abstract}
%\section{Abstract}
NEW ABSTRACT
Accurate simulation of wireless radio signals is a challenging problem.  While
primary effects can easily be calculated, second order effects are numerous
and will often substantially alter the range of the radios.  Many modern
simulators such as ns-3 use a simple, overly conservative calculation known
as the Friis[Citation needed.] equation.

This work demonstrates a more accurate estimate of radio waves via photon
mapping[Cite.].  By utilizing photon mapping we can predict where photons
will travel as well as the objects they will strike.  By collecting the number
of photons to strike an object (e.g. an antenna) the effective signal strength
can be determined.  If the signal strength is above a pre-specified cutoff
then the receiving node can hear the transmitter.

We show that this approach generates a higher fidelity estimate in most
scenarios.  As expected, buildings and obstacles impact radio transmissions
in ways that cannot be modeled by the Friis equation.  While the resolution
of radio transmissions is increased, the amount of computation required for
this result has grown considerably, i.e. A straightforward formula has been
replaced with computing the paths of thousands of photons.

OLD ABSTRACT

Accurate simulation of wireless radio signals is a challenging problem.
While primary effects can be easily calculated, second order effects are
numerous and will often substantially alter the range of the radios.


Simulating wireless networks poses computational problems beyond their wired
counterparts.  Determining which nodes are within transmission range of a given
node's radio when sending is non-trivial.  Implementing this decision problem
in a naive manner will produce an O($n^2$) algorithm.  In a mobile ad-hoc
network this would need to be performed before every transmission.

Visible light and radio waves are essentially the same phenomenon;
we hope to use the abilities of modern GPUs to perform many computations
simultaneously to speed up this problem.  McGuire and Luebke
\cite{mcguire09imagespace} demonstrated real-time photon mapping
of complicated scenes utilizing GPU acceleration.  Schmitz et al.
\cite{Schmitz:2006:ERW:1164717.1164730}
\cite{Schmitz:2006:WPU:1163610.1163638}
improved the accuracy of their ns-2 model via photon mapping.  
Simulators such as ROSS \cite{ross} utilize the Transmission Line Matrix
\cite{Nutaro:2006:DEM:1138464.1138468} to determine which nodes are able
to receive transmissions.  We hope to improve upon both the accuracy and 
run-time of TLM in this work.

\end{abstract}
\vspace{5mm}
% do the keywords
\begin{keywords}
wireless networking, 802.11, simulation, photon mapping, ray tracing
\end{keywords}

% start the main text ...
%----------------------------------------------------------------------
% SECTION I: Introduction
%----------------------------------------------------------------------
\section{Introduction}

Wireless radio communication has become ubiquitous and, in fact, necessary for 
many purposes ranging from widespread wifi hot-spots for web browsing to 
critical military applications.  Whether or not one node is capable of 
hearing another is an essential question, the answer to which will 
determine the effective ability to communicate.

An oracle for deciding whether or not node A can hear node B would be useful 
in this situation.  Unfortunately, such an oracle does not exist and we must 
fall back on approximating an answer.  One such method adopted by ns-2 and 
ns-3 is the Friis[Cite.] equation.  The Friis equation assumes idealized 
conditions and that no other objects interfere with communications.  Clearly 
this is an over-simplification; many materials impact radio wave transmission 
in some, oftentimes beneficial, manner.

In this work we propose an improved method of approximating radio 
transmissions.  By modeling the radio communications as photons, determining 
the signal strength is simply a matter of gathering photons which impact a 
region of interest.  A variation of photon mapping is applicable in this
scenario.  By enclosing radio receivers in bounding spheres, the number of
photons to impact the sphere and, in turn, the signal strength of the radio
signals, can be determined.

Photon mapping algorithm was developed by Jensen[Cite.] 
to improve upon deficiencies in classic ray tracing approaches.  It is a
realistic two-pass global illumination algorithm which consists of shooting
photons into the scene and then performing a local collection step.

\section{Related Work}

\begin{enumerate}
\item photon mapping

\item radio transmission

\item radio transmission using photon mapping (like from other papers, e.g. the
guys who do the beam stuff)
\end{enumerate}

\section{Overview}
Our approach begins by emitting photons from our radio transmitter in a
directional manner.  The output of this transmitter is 250 mW.  We chose this
value in our aim to mimic something along the lines of a typical Wifi base
station such as a Linksys wireless router. 

The central frequency of Channel 6 of a 802.11b\/g router is 2.437 GHz. This frequency
will be used in all test cases for convenience as it is the center channel of 802.11 and
is a popular default for most routers as it is one of the three non-overlapping channels. 
The power of a photon can be determined with the following formula: $E = h\nu$



The amount of power in each photon is based on the number of photons emitted from the base stations
antenna
$\frac{250mW}{\#\;photons}$ is our power per photon.  For our purposes, this
value will be

\begin{enumerate}
\item Replace gather step with object-based photon collection

\item No roof

\item antenna electrodynamics

\item Material stuff

\item ROSS integration

\item Test Cases:
-Light (shape, orientation)\newline
-Multiple Sources? Pointing tx in different directions or use spheres?

\item Source estimates

\item Rx requirements (-100dBm-100pW)

\item OO code mods to objects to determine rx

\item How .obj files were modified

\item OpenMP scalability (possible GPU tie-in)

\item Thread-protecting KD-trees

\item Where do we see substantial improvement over Friis?

\item NS3 assumes unity-gain antenna.  We shall do the same.
\end{enumerate}

\section{Optimizations}
The bulk of our time is spent in the photon emission stage.  Each photon is
independent from all others which allows for simultaneous tracing of all
paths.  While parallel computation was not originally within the scope of this
assignment, we felt our time would be better spent parallelizing a small amount
of code than waiting many times longer for results.

OpenMP \cite{Grama} was designed for code bases just like ours: pre-written and
tested code requiring performance improvements beyond a single core, ideally
needing few modifications to the existing code base.  OpenMP worked well for
us with very few code changes: less than 10 lines of code were changed and
our tracing step went from ~100\% of one core to ~100\% of all four cores on
our iMac, substantially decreasing the runtime of this step.

Beyond OpenMP, few other changes were required.  Most of these were correcting
race conditions in the non-threaded kd-tree.  There are two locations in the
kd-tree where photons are added.  Wrapping these locations in recursive
mutexes solved this particular race condition.  While stating that the kd-tree
is now thread-safe may be premature, the crash has not been seen since this
modification to the kd-trees were made.

\section{Future Work}

CHANGE BEGINNING HERE

A natural improvement on optimizing the photon emission would be adding
GPU support.  This task was originally in our proposal but was cut at some
point as it was overly ambitious.  However, our code was written with
parallel computation in mind and therefore should not be too difficult to
add as an enhancement.  From a funding perspective we should clearly target
GPUs as early as possible as the Department of Defense, more specifically the
Army, have thousands of GPUs that are largely idle.

% do the bibliography:
\bibliographystyle{IEEEbib}
\bibliography{my-bibliography-file}

% where ``my-bibliography-file.bib'' is the name of the file with all the 
% BibTeX entries.

% do the biographies...
%\begin{biography}{Gregory L. Plett}
%  A bio with no face...
%\end{biography}

% If you want a picture with your biography, then specify the name of
% the postscript file in square brackets. That is, uncomment the
% following three lines and change the name of "face.ps" to the name of 
% your file.
%\begin{biography}[face.ps]{Gregory L. Plett}
%  A bio with a face...
%\end{biography}

%----------------------------------------------------------------------
% FIGURES
%----------------------------------------------------------------------
% There are many ways to include figures in the text. We will assume
% that the figure is some sort of EPS file.
%
% The outdated packages epsfig and psfig allow you to insert figures
% like: \psfig{filename.eps} These should really be done now using the
% \includegraphics{filename.eps} command.  
%
% i.e.,
%
% \includegraphics{file.eps}
%
% whenever you want to include the EPS file 'file.eps'. There are many
% options for the includegraphics command, and are outlined in the
% on-line documentation for the "graphics bundle". Using the options,
% you can specify the height, total height (height+depth), width, scale,
% angle, origin, bounding box "bb",view port, and can trim from around
% the sides of the figure. You can also force LaTeX to clip the EPS file
% to the bounding box in the file. I find that I often use the scale,
% trim and clip commands.
% 
% \includegraphics[scale=0.6,trim=0 0 0 0,clip=]{file.eps}
% 
% which magnifies the graphics by 0.6 (If I create a graphics for an
% overhead projector transparency, I find that a magnification of 0.6
% makes it look much better in a paper), trims 0 points off
% of the left, bottom, right and top, and clips the graphics. If the
% trim numbers are negative, space is added around the figure. This can
% be useful to help center the graphics, if the EPS file bounding box is
% not quite right.
% 
% To center the graphics,
% 
% \begin{center}
% \includegraphics...
% \end{center}
% 
% I have not yet written good documentation for this, but another 
% package which helps in figure management is the package ieeefig.sty,
% available at: http://www-isl.stanford.edu/people/glp/ieee.shtml
% Specify:
% 
%\usepackage{ieeefig} 
% 
% in the preamble, and whenever you want a figure,
% 
%\figdef{filename}
% 
% where, filename.tex is a LaTeX file which defines what the figure is.
% It may be as simple as
% 
% \inserteps{filename.eps}
%
% or
% \inserteps[includegraphics options]{filename.eps}
% 
% or may be a very complicated LaTeX file. 

\end{document}
